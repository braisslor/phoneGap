<!DOCTYPE html>
<html><head> 
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
	<meta name = 'viewport' content = 'user-scalable=no,width=device-width,minimum-scale=1.0,maximum-scale=0.6667'/>
	<link href="css/jquery-ui.css" type ="text/css" rel="stylesheet" />
	<script src='js/jquery.min.js'></script>
	<script src='js/jquery-ui.min.js'></script>
	<script language="Javascript" src="http://www.codehelper.io/api/ips/?js"></script>
	<style> #slider { margin: 20px; } </style>
	<script>
		var roVar = 1; 
		var WANIP='107.223.141.134';
		var LANIP='192.168.10.201';
		var ipText="";
		function changeLight(event, ui) { 
			document.getElementById('t').innerHTML='<center>Sending';
			setTimeout(function(){document.getElementById('t').innerHTML='<center>Control the Fan!'},450);
			updateIPText();
			$.post(ipText, { li: ui.value } ); 
		}
		$(document).ready(
			function(){ 
				updateIPText(); 
				$('#slider').slider({min: 1, max:19, change:changeLight}); 
				}
		);
		function updateIPText() {
			document.getElementById('n').innerHTML=codehelper_ip.IP;
			if (codehelper_ip.IP == LANIP) {
				ipTEXT = 'http://' + LANIP + '/';
				document.getElementById('d').innerHTML='Using local IP';
			} else {
				ipTEXT = 'http://' + WANIP + ':245/';
				document.getElementById('d').innerHTML='Using Long Distance IP';
			}
		}		
		function butPressed(butVal) {
			document.getElementById('t').innerHTML='<center>Sending';
			updateIPText();
			setTimeout(function(){document.getElementById('t').innerHTML='<center>Control the Fan!'},450);
			$.post(ipText, { ro: roVar, li: butVal} );
			$('#slider').slider({min: 1, max:19, change:changeLight});
		}
		function changeRoom(roNum) { 
			roVar = roNum;
		}
		function checkConnection() {
			document.getElementById('d').innerHTML='<center>Pushed';
            var networkState = navigator.connection.type;

            var states = {};
            states[Connection.UNKNOWN]  = 'Unknown connection';
            states[Connection.ETHERNET] = 'Ethernet connection';
            states[Connection.WIFI]     = 'WiFi connection';
            states[Connection.CELL_2G]  = 'Cell 2G connection';
            states[Connection.CELL_3G]  = 'Cell 3G connection';
            states[Connection.CELL_4G]  = 'Cell 4G connection';
            states[Connection.CELL]     = 'Cell generic connection';
            states[Connection.NONE]     = 'No network connection';
			document.getElementById('n').innerHTML=states[networkState];
        }		
	</script>
</head>
<body>
	<h1 id='t'><center>Control the Fan!</h1>
	<center>
	<button onclick='butPressed(21)'>LIGHT</button>
	<div id="slider" value=10></div>
	<h1>Fan:</h1>
	<button onclick='butPressed(22)'>OFF</button>
	<button onclick='butPressed(23)'>LOW</button>
	<button onclick='butPressed(24)'>MED</button>
	<button onclick='butPressed(25)'>HIGH</button><br>
	<button onclick='checkConnection()'>Debug</button>
	<p id='d'></p>
	<p id ='n'></p>
</body></html>